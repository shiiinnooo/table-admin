import{G as T,i as N,f as q,g as z,h as F}from"./global-BXdsiJWc.js";import{B as G,h as J,o as p,c as m,m as b,k as w,p as v,a as e,Y as j,$ as I,a0 as A,a1 as i,a2 as E,a4 as H,a5 as k,l as S,w as h,q as l,C as d,A as L,a3 as x,a7 as M,I as P,H as K,E as V,a6 as Q}from"./index-DS2ib-8W.js";import"./index-eqgO6_rb.js";var W=function(r){var s=r.dt;return`
.p-card {
    background: `.concat(s("card.background"),`;
    color: `).concat(s("card.color"),`;
    box-shadow: `).concat(s("card.shadow"),`;
    border-radius: `).concat(s("card.border.radius"),`;
    display: flex;
    flex-direction: column;
}

.p-card-caption {
    display: flex;
    flex-direction: column;
    gap: `).concat(s("card.caption.gap"),`;
}

.p-card-body {
    padding: `).concat(s("card.body.padding"),`;
    display: flex;
    flex-direction: column;
    gap: `).concat(s("card.body.gap"),`;
}

.p-card-title {
    font-size: `).concat(s("card.title.font.size"),`;
    font-weight: `).concat(s("card.title.font.weight"),`;
}

.p-card-subtitle {
    color: `).concat(s("card.subtitle.color"),`;
}
`)},X={root:"p-card p-component",header:"p-card-header",body:"p-card-body",caption:"p-card-caption",title:"p-card-title",subtitle:"p-card-subtitle",content:"p-card-content",footer:"p-card-footer"},Z=G.extend({name:"card",theme:W,classes:X}),ee={name:"BaseCard",extends:J,style:Z,provide:function(){return{$pcCard:this,$parentInstance:this}}},R={name:"Card",extends:ee,inheritAttrs:!1};function se(t,r,s,_,O,u){return p(),m("div",b({class:t.cx("root")},t.ptmi("root")),[t.$slots.header?(p(),m("div",b({key:0,class:t.cx("header")},t.ptm("header")),[w(t.$slots,"header")],16)):v("",!0),e("div",b({class:t.cx("body")},t.ptm("body")),[t.$slots.title||t.$slots.subtitle?(p(),m("div",b({key:0,class:t.cx("caption")},t.ptm("caption")),[t.$slots.title?(p(),m("div",b({key:0,class:t.cx("title")},t.ptm("title")),[w(t.$slots,"title")],16)):v("",!0),t.$slots.subtitle?(p(),m("div",b({key:1,class:t.cx("subtitle")},t.ptm("subtitle")),[w(t.$slots,"subtitle")],16)):v("",!0)],16)):v("",!0),e("div",b({class:t.cx("content")},t.ptm("content")),[w(t.$slots,"content")],16),t.$slots.footer?(p(),m("div",b({key:1,class:t.cx("footer")},t.ptm("footer")),[w(t.$slots,"footer")],16)):v("",!0)],16)],16)}R.render=se;const te={class:"mb-2"},oe={class:"mb-2"},ae={key:0},ne={class:"flex flex-row mt-6 px-3"},ie={class:"flex flex-col gap-4 w-1/2 pr-2"},de={class:"flex flex-col gap-1"},le={class:"flex"},re={class:"basis-3/4"},ce={class:"flex"},pe={class:"basis-3/4"},me={class:"flex"},ue={class:"basis-3/4"},fe={class:"flex"},he={class:"basis-3/4"},ge={class:"flex"},be={class:"basis-3/4"},ve={class:"flex"},_e={class:"basis-3/4"},ye={class:"flex flex-col gap-4 w-1/2"},xe={class:"flex flex-col gap-4"},$e=["src"],we={class:"flex flex-col gap-1"},ke={class:"text-end font-semibold"},Oe={__name:"OrderModal",setup(t){const r=j(!1),s=I({id:"",create_at:"",is_paid:"",message:"",paid_date:"",products:"",total:"",user:""});A(()=>{i.on("handleOpenOrderModal",u=>{_(u)})}),E(()=>{i.off("handleOpenOrderModal")});const _=u=>{i.emit("handleLoadingShow"),H.Order.getInfo(u).then(o=>{Object.keys(s).forEach($=>{s[$]=o.order[$]}),i.emit("handleLoadingHide"),r.value=!0},o=>{k.error(o.message),i.emit("handleLoadingHide")})},O=u=>{window.open(`https://shiiinnooo.github.io/table/#/checkout/step3/${u}`,"_blank")};return(u,o)=>{const $=N,B=V,a=R,n=Q;return p(),S(n,{visible:r.value,"onUpdate:visible":o[1]||(o[1]=g=>r.value=g),modal:"",header:"訂單詳情",style:{width:"45rem",padding:"0 0 20px 0"}},{default:h(()=>{var g,f,D,C;return[l(a,{style:{border:"1px solid #e0e0e0","border-radius":"4px","box-shadow":"0"}},{content:h(()=>[e("p",te,"訂單編號："+d(s.id),1),e("p",oe,[o[2]||(o[2]=L("付款狀態： ")),l($,{severity:s.is_paid?"success":"danger",value:s.is_paid?"已付款":"未付款"},null,8,["severity","value"]),s.is_paid?v("",!0):(p(),S(B,{key:0,class:"ml-2",label:"付款連結",severity:"contrast",onClick:o[0]||(o[0]=y=>O(s.id))}))]),s.is_paid?(p(),m("p",ae,"付款時間："+d(x(M).unix(s.paid_date).format("YYYY-MM-DD HH:mm:ss")),1)):v("",!0)]),_:1}),e("div",ne,[e("div",ie,[o[9]||(o[9]=e("div",{class:"font-semibold text-lg"},"訂購資訊",-1)),e("div",de,[e("div",le,[o[3]||(o[3]=e("span",{class:"basis-1/4 font-semibold"},"建立時間",-1)),e("span",re,d(x(M).unix(s.create_at).format("YYYY-MM-DD HH:mm:ss")),1)]),e("div",ce,[o[4]||(o[4]=e("span",{class:"basis-1/4 font-semibold"},"Email",-1)),e("span",pe,d((g=s.user)==null?void 0:g.email),1)]),e("div",me,[o[5]||(o[5]=e("span",{class:"basis-1/4 font-semibold"},"姓名",-1)),e("span",ue,d((f=s.user)==null?void 0:f.name),1)]),e("div",fe,[o[6]||(o[6]=e("span",{class:"basis-1/4 font-semibold"},"手機",-1)),e("span",he,d((D=s.user)==null?void 0:D.tel),1)]),e("div",ge,[o[7]||(o[7]=e("span",{class:"basis-1/4 font-semibold"},"地址",-1)),e("span",be,d((C=s.user)==null?void 0:C.address),1)]),e("div",ve,[o[8]||(o[8]=e("span",{class:"basis-1/4 font-semibold"},"備註",-1)),e("span",_e,d(s.message?s.message:"-"),1)])])]),e("div",ye,[o[10]||(o[10]=e("div",{class:"font-semibold text-lg"},"訂單內容",-1)),e("div",xe,[(p(!0),m(P,null,K(s.products,(y,Y)=>(p(),m("div",{class:"flex items-center gap-4",key:Y},[e("img",{src:y.product.imageUrl,alt:"image",style:{"object-fit":"cover !important",height:"60px !important",width:"60px !important"}},null,8,$e),e("div",we,[e("span",null,d(y.product.title),1),e("span",null,"價格：NT. "+d(x(T).toThousands(y.product.price)),1),e("span",null,"數量："+d(y.qty),1)])]))),128))]),o[11]||(o[11]=e("hr",null,null,-1)),e("span",ke,"總計：NT. "+d(x(T).toThousands(s.total)),1)])])]}),_:1},8,["visible"])}}},De={class:"card"},Ce={class:"flex justify-between mb-5"},Ye={class:"flex"},Be={__name:"Order",setup(t){const r=I({list:[],pagination:{}}),s=j(0);A(()=>{_(),i.on("handleDeleteOrder",a=>{$(a)}),i.on("handleDeleteAllOrder",()=>{B()})}),E(()=>{i.off("handleDeleteOrder"),i.off("handleDeleteAllOrder")});const _=(a=1)=>{i.emit("handleLoadingShow"),H.Order.getList({page:a}).then(n=>{r.list=n.orders,r.pagination=n.pagination,s.value=(n.pagination.current_page-1)*10,i.emit("handleLoadingHide")},n=>{i.emit("handleLoadingHide")})},O=a=>{s.value=a.first,_(a.page+1)},u=a=>{i.emit("handleOpenOrderModal",a)},o=(a,n)=>{i.emit("handleShowConfirmDialog",{header:a?"刪除所有訂單":"刪除訂單",message:a?"":"確認是否刪除以下訂單？(刪除後不可復原)",item:a?"確認是否刪除所有訂單？(刪除後不可復原)":n.id,payload:a?"":n.id,confirmFunction:a?"handleDeleteAllOrder":"handleDeleteOrder"})},$=a=>{i.emit("handleLoadingShow"),H.Order.delete(a).then(n=>{i.emit("handleCloseConfirmDialog"),_(s.value/10+1),k.success(n.message)},n=>{k.error(n.message),i.emit("handleLoadingHide")})},B=()=>{i.emit("handleLoadingShow"),H.Order.deleteAll().then(a=>{i.emit("handleCloseConfirmDialog"),_(),k.success(a.message)},a=>{k.error(a.message),i.emit("handleLoadingHide")})};return(a,n)=>{var Y;const g=V,f=F,D=N,C=q,y=z;return p(),m(P,null,[e("div",De,[e("div",Ce,[n[1]||(n[1]=e("div",{class:"font-semibold text-xl"},"訂單管理",-1)),l(g,{type:"button",icon:"pi pi-trash",label:"刪除所有訂單",severity:"danger",onClick:n[0]||(n[0]=c=>o(!0)),disabled:!r.list.length},null,8,["disabled"])]),l(C,{value:r.list,rows:10},{empty:h(()=>n[2]||(n[2]=[e("div",{class:"min-h-48 flex items-center"},"No Data",-1)])),default:h(()=>[l(f,{field:"create_at",header:"訂單建立時間",style:{"min-width":"200px"}},{body:h(({data:c})=>[L(d(x(M).unix(c.create_at).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1}),l(f,{field:"id",header:"訂單編號",style:{"min-width":"220px"}}),l(f,{field:"total",header:"金額",style:{"min-width":"150px"}},{body:h(({data:c})=>[L(d(`NT. ${x(T).toThousands(c.total)}`),1)]),_:1}),l(f,{field:"is_paid",header:"付款狀態",style:{"min-width":"150px"}},{body:h(({data:c})=>[l(D,{value:c.is_paid?"已付款":"未付款",severity:c.is_paid?"success":"danger"},null,8,["value","severity"])]),_:1}),l(f,{field:"paid_date",header:"付款時間",style:{"min-width":"200px"}},{body:h(({data:c})=>[L(d(c.paid_date?x(M).unix(c.paid_date).format("YYYY-MM-DD HH:mm:ss"):"-"),1)]),_:1}),l(f,{field:"action",header:"功能",style:{"min-width":"150px"}},{body:h(({data:c})=>[e("div",Ye,[l(g,{icon:"pi pi-search",severity:"secondary",rounded:"",onClick:U=>u(c.id)},null,8,["onClick"]),l(g,{icon:"pi pi-times",severity:"danger",variant:"text",rounded:"",onClick:U=>o(!1,c)},null,8,["onClick"])])]),_:1})]),_:1},8,["value"]),(Y=r.pagination)!=null&&Y.total_pages?(p(),S(y,{key:0,first:s.value,rows:10,totalRecords:r.pagination.total_pages*10,onPage:O,class:"flex justify-end"},null,8,["first","totalRecords"])):v("",!0)]),l(Oe)],64)}}};export{Be as default};
